# Copyright (c) 2021 Project CHIP Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
import("//args.gni")
import("//build_overrides/bouffalolab_iot_sdk.gni")
import("//build_overrides/chip.gni")
import("//build_overrides/mbedtls.gni")
import("${chip_root}/src/lib/lib.gni")

declare_args() {
  # Location of the bl616 SDK.
  bouffalo_sdk_root = "${chip_root}/third_party/bouffalolab/repo_bouffalo_sdk"

  enable_debug_coredump = false
  coredump_binary_id = 0
  bouffalo_sdk_coredump_version = 1
}

assert(bouffalo_sdk_root != "", "bouffalo_sdk_root must be specified")

# Defines an bl616 SDK build target.
#
# Parameters:
#   bouffalo_sdk_root - The location of the bl616 SDK.
#   sources - The sources files to build.
template("bouffalo_sdk") {
  if (defined(invoker.bouffalo_sdk_root)) {
    bouffalo_sdk_root = invoker.bouffalo_sdk_root
  }

  assert(bouffalo_sdk_root != "", "bouffalo_sdk_root must be specified")

  sdk_target_name = target_name

  config("${sdk_target_name}_config") {
    defines = [
      "BL616=BL616",
      "ARCH_RISCV",
    ]

    include_dirs = []
    if (defined(invoker.include_dirs)) {
      include_dirs += invoker.include_dirs
    }

    if (defined(invoker.defines)) {
      defines += invoker.defines
    }

    cflags_c = [
      "-fno-jump-tables",
      "-fstrict-volatile-bitfields",
      "-fshort-enums",
      "-Wno-unused-but-set-variable",
      "-Wno-sign-compare",
    ]

    cflags = [
      "-Wno-conversion",
      "-fstack-usage",
    ]

    if (defined(invoker.defines)) {
      defines += invoker.defines
    }
  }

  config("${sdk_target_name}_config_startup") {
    include_dirs = [ "${bouffalo_sdk_root}/drivers/soc/bl616/std/startup" ]
  }

  source_set("${sdk_target_name}_startup") {
    defines = [
      "ARCH_RISCV",
      "BFLB_USE_HAL_DRIVER",
      "CONFIG_IRQ_NUM=80",
    ]

    if (defined(invoker.enable_debug_coredump) &&
        invoker.enable_debug_coredump) {
      defines += [ "CONFIG_COREDUMP" ]
    }

    include_dirs = [ "${bouffalo_sdk_root}/drivers/soc/bl616/std/startup" ]

    sources = [
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/startup/interrupt.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/startup/riscv_fpu.S",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/startup/start.S",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/startup/start_load.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/startup/system_bl616.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/startup/vector.S",
    ]

    cflags_c = [ "-Wno-sign-compare" ]

    configs += [
      ":${sdk_target_name}_config_std_drv",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_utils",
      ":${sdk_target_name}_config_freertos",
    ]

    public_configs = [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_startup",
    ]
  }

  config("${sdk_target_name}_config_std_drv") {
    include_dirs = [
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/include",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/include/hardware",
    ]

    defines = [
      "ARCH_RISCV",
      "BFLB_USE_HAL_DRIVER",
    ]

    cflags = [ "-Wsign-compare" ]
  }

  source_set("${sdk_target_name}_std_drv") {
    defines = [
      "ARCH_RISCV",
      "BFLB_USE_ROM_DRIVER",
    ]

    include_dirs = [
      #bl616 startup
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/include",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/include/hardware",
    ]

    sources = [
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/port/bl616_clock.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/port/bl616_gpio.c",
    ]

    sources += [
      #use rom api default
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_clock.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_common.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_ef_cfg.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_mfg_efuse.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_mfg_flash.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_mfg_media.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_pm.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_psram.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_romapi_e907.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_romapi_patch.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_sdh.c",
      "${bouffalo_sdk_root}/drivers/soc/bl616/std/src/bl616_tzc_sec.c",
    ]

    cflags_c = [
      "-Wno-sign-compare",
      "-Wno-enum-conversion",
      "-Wno-type-limits",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_startup",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_freertos",
    ]
    public_configs = [ ":${sdk_target_name}_config_std_drv" ]
  }

  config("${sdk_target_name}_config_lhal") {
    include_dirs = [
      #bl616 lhal
      "${bouffalo_sdk_root}/drivers/lhal/include",
      "${bouffalo_sdk_root}/drivers/lhal/include/arch",
      "${bouffalo_sdk_root}/drivers/lhal/include/arch/risc-v/t-head",
      "${bouffalo_sdk_root}/drivers/lhal/include/arch/risc-v/t-head/Core/Include",
      "${bouffalo_sdk_root}/drivers/lhal/include/arch/risc-v/t-head/csi_dsp/include",
      "${bouffalo_sdk_root}/drivers/lhal/src/flash",
      "${bouffalo_sdk_root}/drivers/lhal/config/bl616",
    ]
  }

  source_set("${sdk_target_name}_lhal") {
    defines = [
      "CPU_M0",
      "CONFIG_IRQ_NUM=80",
    ]

    include_dirs = [ "${bouffalo_sdk_root}/drivers/lhal/include" ]

    sources = [
      "${bouffalo_sdk_root}/drivers/lhal/config/bl616/device_table.c",
      "${bouffalo_sdk_root}/drivers/lhal/include/arch/risc-v/t-head/rv_hart.c",
      "${bouffalo_sdk_root}/drivers/lhal/include/arch/risc-v/t-head/rv_pmp.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_acomp.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_adc.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_auadc.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_audac.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_cam.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_cks.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_common.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_dac.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_dbi.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_dma.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_ef_ctrl.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_emac.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_flash.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_gpio.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_i2c.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_i2s.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_ir.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_irq.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_l1c.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_mjpeg.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_mtimer.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_pwm_v2.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_rtc.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_sdio2.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_sec_aes.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_sec_sha.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_sec_trng.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_spi.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_timer.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_uart.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/bflb_wdg.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/flash/bflb_sf_cfg.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/flash/bflb_sf_ctrl.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/flash/bflb_sflash.c",
      "${bouffalo_sdk_root}/drivers/lhal/src/flash/bflb_xip_sflash.c",
    ]

    libs = [ "${bouffalo_sdk_root}/drivers/lhal/src/pka/libpka_bl616.a" ]

    cflags_c = [ "-Wno-shadow" ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_std_drv",
    ]

    public_configs = [ ":${sdk_target_name}_config_lhal" ]
  }

  config("${sdk_target_name}_config_sys") {
    include_dirs = [
      "${bouffalo_sdk_root}/drivers/sys",
      "${bouffalo_sdk_root}/drivers/sys/bl616",
    ]
  }

  source_set("${sdk_target_name}_sys") {
    defines = [ "BL_WIFI_LP_FW" ]
    sources = [
      "${bouffalo_sdk_root}/drivers/sys/bl616/bl616_lp.c",
      "${bouffalo_sdk_root}/drivers/sys/bl616/bl616_sys.c",
    ]

    cflags_c = [
      "-Wno-shadow",
      "-Wno-format",
      "-Wno-format-nonliteral",
      "-Wno-format-security",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_std_drv",
      ":${sdk_target_name}_config_lhal",
    ]
    public_configs = [ ":${sdk_target_name}_config_sys" ]
  }

  config("${sdk_target_name}_config_board") {
    include_dirs = [ "${bouffalo_sdk_root}/bsp/board" ]
  }

  source_set("${sdk_target_name}_board") {
    defines = [ "CONFIG_MBEDTLS" ]

    include_dirs = [ "${bouffalo_sdk_root}/bsp/board/bl616dk" ]

    sources = [
      "${bouffalo_sdk_root}/bsp/board/bl616dk/board.c",
      "${bouffalo_sdk_root}/bsp/board/bl616dk/board_flash_psram.c",
      "${bouffalo_sdk_root}/bsp/board/bl616dk/board_gpio.c",
      "${bouffalo_sdk_root}/bsp/board/bl616dk/board_rf.c",
      "${bouffalo_sdk_root}/bsp/board/bl616dk/fw_header.c",
    ]

    cflags_c = [
      "-Wno-sign-compare",
      "-Wno-type-limits",
      "-Wno-shadow",
      "-Wno-format",
      "-Wno-format-nonliteral",
      "-Wno-format-security",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_std_drv",
      ":${sdk_target_name}_config_rf",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_mm",
    ]

    public_configs = [ ":${sdk_target_name}_config_board" ]
  }

  config("${sdk_target_name}_config_eth_phy") {
    include_dirs = [
      "${bouffalo_sdk_root}/bsp/common/eth_phy",
      "${bouffalo_sdk_root}/bsp/common/eth_phy/lwip_netif_emac",
    ]
  }

  source_set("${sdk_target_name}_eth_phy") {
    sources = [
      "${bouffalo_sdk_root}/bsp/common/eth_phy/ephy_general.c",
      "${bouffalo_sdk_root}/bsp/common/eth_phy/ephy_lan8720.c",
      "${bouffalo_sdk_root}/bsp/common/eth_phy/eth_phy.c",
      "${bouffalo_sdk_root}/bsp/common/eth_phy/eth_phy_port.c",
      "${bouffalo_sdk_root}/bsp/common/eth_phy/lwip_netif_emac/lwip_netif_emac.c",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_std_drv",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_utils",
      ":${sdk_target_name}_config_lwip",
      ":${sdk_target_name}_config_freertos",
    ]

    public_configs = [ ":${sdk_target_name}_config_eth_phy" ]
  }

  config("${sdk_target_name}_config_shell") {
    include_dirs = [ "${bouffalo_sdk_root}/components/shell" ]
  }

  source_set("${sdk_target_name}_shell") {
    include_dirs = [ "${bouffalo_sdk_root}/bsp/board/bl616dk" ]

    sources = [
      "${bouffalo_sdk_root}/components/shell/shell.c",
      "${bouffalo_sdk_root}/components/shell/shell_freertos.c",
    ]

    cflags_c = [
      "-Wno-shadow",
      "-Wno-format-security",
      "-Wno-format-nonliteral",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_utils",
      ":${sdk_target_name}_config_freertos",
    ]
    public_configs = [ ":${sdk_target_name}_config_shell" ]
  }

  config("${sdk_target_name}_config_rf") {
    include_dirs = [
      "${bouffalo_sdk_root}/drivers/soc/bl616/phyrf/include",
      "${bouffalo_sdk_root}/drivers/rfparam/Inc",
    ]

    defines = [ "WL_BL616=1" ]
  }

  source_set("${sdk_target_name}_rf") {
    include_dirs = [ "${bouffalo_sdk_root}/drivers/rfparam/Inc" ]

    sources = [
      "${bouffalo_sdk_root}/drivers/rfparam/Src/rfparam_adapter.c",
      "${bouffalo_sdk_root}/drivers/rfparam/Src/rfparam_rftlv.c",
    ]

    libs = [ "${bouffalo_sdk_root}/drivers/soc/bl616/phyrf/lib-gcc_10.2.0-toolchain_V2.6.1/libbl616_phyrf.a" ]

    cflags_c = [ "-Wno-shadow" ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_std_drv",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_utils",
    ]
    public_configs = [ ":${sdk_target_name}_config_rf" ]
  }

  source_set("${sdk_target_name}_libc") {
    include_dirs = [ "${bouffalo_sdk_root}/components/libc" ]

    sources = [
      "${bouffalo_sdk_root}/components/libc/assert.c",
      "${bouffalo_sdk_root}/components/libc/newlib/port_init_fini.c",
      "${bouffalo_sdk_root}/components/libc/newlib/port_memory.c",
      "${bouffalo_sdk_root}/components/libc/newlib/syscalls_nosys.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_abs.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_atof.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_atoi.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_atol.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_atoll.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_bsearch.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_checkbase.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_itoa.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_llabs.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_lldiv.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_qsort.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/stdlib/lib_strtod.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_ffs.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_ffsl.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_ffsll.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_fls.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_flsl.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_flsll.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_index.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_memccpy.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_memchr.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_memcmp.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_memmove.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_memrchr.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_memset.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_stpcpy.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_stpncpy.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strcasecmp.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strcasestr.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strcat.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strchr.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strcmp.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strcspn.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strdup.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strnlen.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strpbrk.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strsep.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strspn.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strstr.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strtok.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_strtokr.c",
      "${bouffalo_sdk_root}/components/libc/nuttx/libc/string/lib_vikmemcpy.c",
      "${bouffalo_sdk_root}/components/libc/printf.c",
      "${bouffalo_sdk_root}/components/libc/snprintf.c",
      "${bouffalo_sdk_root}/components/libc/sprintf.c",
      "${bouffalo_sdk_root}/components/libc/stdatomic.c",
      "${bouffalo_sdk_root}/components/libc/vsnprintf.c",
      "${bouffalo_sdk_root}/components/libc/vsprintf.c",
    ]

    cflags = [
      "-Wno-nonnull-compare",
      "-Wno-builtin-declaration-mismatch",
      "-Wno-implicit-fallthrough",
      "-Wno-format",
      "-Wno-format-truncation",
    ]
    configs += [
      ":${sdk_target_name}_config_mm",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_utils",
    ]
    public_configs = [ ":${sdk_target_name}_config" ]
  }

  config("${sdk_target_name}_config_freertos") {
    defines = [ "CONFIG_FREERTOS" ]

    include_dirs = [
      "${bouffalo_sdk_root}/components/os/freertos/include",
      "${bouffalo_sdk_root}/components/os/freertos/portable/GCC/RISC-V/common",
      "${bouffalo_sdk_root}/components/os/freertos/portable/GCC/RISC-V/common/chip_specific_extensions/RV32I_CLINT_no_extensions",
    ]
  }

  source_set("${sdk_target_name}_freertos") {
    defines = [
      "portasmHANDLE_INTERRUPT=interrupt_entry",
      "default_interrupt_handler=freertos_risc_v_trap_handler",
    ]

    include_dirs = [
      "${bouffalo_sdk_root}/components/os/freertos/include",
      "${bouffalo_sdk_root}/components/os/freertos/portable/GCC/RISC-V/common",
      "${bouffalo_sdk_root}/components/os/freertos/portable/GCC/RISC-V/common/chip_specific_extensions/RV32I_CLINT_no_extensions",
    ]

    sources = [
      "${bouffalo_sdk_root}/components/os/freertos/croutine.c",
      "${bouffalo_sdk_root}/components/os/freertos/event_groups.c",
      "${bouffalo_sdk_root}/components/os/freertos/freertos_port.c",
      "${bouffalo_sdk_root}/components/os/freertos/list.c",
      "${bouffalo_sdk_root}/components/os/freertos/portable/GCC/RISC-V/common/port.c",
      "${bouffalo_sdk_root}/components/os/freertos/portable/GCC/RISC-V/common/portASM.S",
      "${bouffalo_sdk_root}/components/os/freertos/portable/MemMang/heap_3.c",
      "${bouffalo_sdk_root}/components/os/freertos/queue.c",
      "${bouffalo_sdk_root}/components/os/freertos/tasks.c",
      "${bouffalo_sdk_root}/components/os/freertos/timers.c",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_mm",
    ]

    public_configs = [ ":${sdk_target_name}_config_freertos" ]
  }

  config("${sdk_target_name}_config_mm") {
    include_dirs = [ "${bouffalo_sdk_root}/components/mm" ]
  }

  source_set("${sdk_target_name}_mm") {
    defines = [ "CONFIG_TLSF" ]

    include_dirs = [ "${bouffalo_sdk_root}/components/mm/tlsf" ]

    sources = [
      "${bouffalo_sdk_root}/components/mm/mm.c",
      "${bouffalo_sdk_root}/components/mm/mm_debug.c",
      "${bouffalo_sdk_root}/components/mm/tlsf/tlsf.c",
      "${bouffalo_sdk_root}/components/mm/tlsf/tlsf_allocator.c",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_freertos",
      ":${sdk_target_name}_config_utils",
    ]

    public_configs = [ ":${sdk_target_name}_config_mm" ]
  }

  config("${sdk_target_name}_config_littlefs") {
    include_dirs = [
      "${bouffalo_sdk_root}/components/fs/littlefs/littlefs",
      "${bouffalo_sdk_root}/components/fs/littlefs/port",
    ]

    defines = [ "LFS_THREADSAFE" ]
  }

  source_set("${sdk_target_name}_littlefs") {
    include_dirs = [
      "${bouffalo_sdk_root}/components/fs/littlefs/littlefs",
      "${bouffalo_sdk_root}/components/fs/littlefs/port",
    ]

    sources = [
      "${bouffalo_sdk_root}/components/fs/littlefs/easyflash_port/lfs_easyflash.c",
      "${bouffalo_sdk_root}/components/fs/littlefs/littlefs/lfs.c",
      "${bouffalo_sdk_root}/components/fs/littlefs/littlefs/lfs_util.c",
      "${bouffalo_sdk_root}/components/fs/littlefs/port/lfs_xip_flash.c",
    ]

    cflags_c = [
      "-Wno-shadow",
      "-Wno-format",
      "-Wno-format-nonliteral",
      "-Wno-format-security",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_utils",
      ":${sdk_target_name}_config_freertos",
    ]

    public_configs = [ ":${sdk_target_name}_config_littlefs" ]
  }

  config("${sdk_target_name}_config_utils") {
    include_dirs = [
      "${bouffalo_sdk_root}/components/utils/async_event",
      "${bouffalo_sdk_root}/components/utils/bflb_mtd/include",
      "${bouffalo_sdk_root}/components/utils/bflb_ota",
      "${bouffalo_sdk_root}/components/utils/coredump",
      "${bouffalo_sdk_root}/components/utils/partition",
      "${bouffalo_sdk_root}/components/utils/getopt",
      "${bouffalo_sdk_root}/components/utils/log",
      "${bouffalo_sdk_root}/components/utils/log/bflb_log",
      "${bouffalo_sdk_root}/components/utils/list",
      "${bouffalo_sdk_root}/components/utils/ring_buffer",
      "${bouffalo_sdk_root}/components/utils/math/include",
    ]

    defines = [ "CONFIG_LOG_LEVEL=0" ]
  }

  source_set("${sdk_target_name}_utils") {
    defines = []
    if (defined(invoker.enable_debug_coredump) &&
        invoker.enable_debug_coredump) {
      defines += [ "CONFIG_COREDUMP" ]
    }

    sources = [
      "${bouffalo_sdk_root}/components/utils/async_event/async_event.c",
      "${bouffalo_sdk_root}/components/utils/async_event/rtos_al.c",
      "${bouffalo_sdk_root}/components/utils/bflb_mtd/bflb_boot2.c",
      "${bouffalo_sdk_root}/components/utils/bflb_mtd/bflb_mtd.c",
      "${bouffalo_sdk_root}/components/utils/bflb_ota/bflb_ota.c",
      "${bouffalo_sdk_root}/components/utils/bflb_ota/utils_sha256.c",
      "${bouffalo_sdk_root}/components/utils/getopt/utils_getopt.c",
      "${bouffalo_sdk_root}/components/utils/log/bflb_log/bflb_log.c",
      "${bouffalo_sdk_root}/components/utils/log/log.c",
      "${bouffalo_sdk_root}/components/utils/math/src/utils_base64.c",
      "${bouffalo_sdk_root}/components/utils/math/src/utils_crc.c",
      "${bouffalo_sdk_root}/components/utils/math/src/utils_hex.c",
      "${bouffalo_sdk_root}/components/utils/partition/partition.c",
      "${bouffalo_sdk_root}/components/utils/ring_buffer/ring_buffer.c",
    ]

    if (defined(invoker.enable_debug_coredump) &&
        invoker.enable_debug_coredump) {
      if (bouffalo_sdk_coredump_version == 1) {
        sources += [
          "${bouffalo_sdk_root}/components/utils/coredump/bin_fmt_v1.c",
          "${bouffalo_sdk_root}/components/utils/coredump/coredump.c",
          "${bouffalo_sdk_root}/components/utils/coredump/encoder_v1.c",
        ]
      } else if (bouffalo_sdk_coredump_version == 2) {
        sources += [
          "${bouffalo_sdk_root}/components/utils/coredump/bin_fmt_v2.c",
          "${bouffalo_sdk_root}/components/utils/coredump/coredump.c",
          "${bouffalo_sdk_root}/components/utils/coredump/encoder_v2.c",
        ]
      }
    }

    cflags_c = [
      "-Wno-type-limits",
      "-Wno-format",
      "-Wno-format-nonliteral",
      "-Wno-format-security",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_startup",
      ":${sdk_target_name}_config_std_drv",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_freertos",
    ]

    public_configs = [ ":${sdk_target_name}_config_utils" ]
  }

  config("${sdk_target_name}_config_mbedtls") {
    include_dirs = [
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/include",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/hw_acc",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port",
    ]

    defines = [ "MBEDTLS_CONFIG_FILE=\"bl616-chip-mbedtls-config.h\"" ]
  }

  source_set("${sdk_target_name}_mbedtls") {
    include_dirs =
        [ "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library" ]

    sources = [
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/hw_acc/aes_alt.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/hw_acc/bignum_alt.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/hw_acc/bignum_ext.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/hw_acc/ecp_alt.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/hw_acc/ecp_curves_alt.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/hw_acc/sha1_alt.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/hw_acc/sha256_alt.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/hw_acc/sha512_alt.c",
    ]

    sources += [
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/bignum.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/entropy_poll_alt.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/net_sockets.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/port/sec_mutex.c",
    ]

    sources += [
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls//library/poly1305.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls//library/ripemd160.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls//library/rsa.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls//library/rsa_internal.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/aes.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/aesni.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/arc4.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/aria.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/asn1parse.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/asn1write.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/base64.c",

      #      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/bignum.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/blowfish.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/camellia.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ccm.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/certs.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/chacha20.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/chachapoly.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/cipher.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/cipher_wrap.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/cmac.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/constant_time.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ctr_drbg.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/debug.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/des.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/dhm.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ecdh.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ecdsa.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ecjpake.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ecp.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ecp_curves.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/entropy.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/entropy_poll.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/error.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/gcm.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/havege.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/hkdf.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/hmac_drbg.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/md.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/md2.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/md4.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/md5.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/memory_buffer_alloc.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/mps_reader.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/mps_trace.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/nist_kw.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/oid.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/padlock.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/pem.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/pk.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/pk_wrap.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/pkcs11.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/pkcs12.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/pkcs5.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/pkparse.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/pkwrite.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/platform.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/platform_util.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/sha1.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/sha256.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/sha512.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ssl_cache.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ssl_ciphersuites.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ssl_cli.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ssl_cookie.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ssl_msg.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ssl_srv.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ssl_ticket.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ssl_tls.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/ssl_tls13_keys.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/threading.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/timing.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/version.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/version_features.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/x509.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/x509_create.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/x509_crl.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/x509_crt.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/x509_csr.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/x509write_crt.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/x509write_csr.c",
      "${bouffalo_sdk_root}/components/crypto/mbedtls/mbedtls/library/xtea.c",
    ]

    cflags_c = [
      "-Wno-format",
      "-Wno-format-security",
      "-Wno-format-nonliteral",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_freertos",
      ":${sdk_target_name}_config_lwip",
    ]

    public_configs = [ ":${sdk_target_name}_config_mbedtls" ]
  }

  config("${sdk_target_name}_config_lwip") {
    include_dirs = [
      "${bouffalolab_iot_sdk_build_root}/bl616",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/system",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/include",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/compat/posix",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/include/compat/posix",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/lwip-port",
    ]

    include_dirs +=
        [ "${bouffalo_sdk_root}/components/net/lwip/lwip/src/apps/dhcpd" ]
  }

  source_set("${sdk_target_name}_lwip") {
    sources = [
      "${bouffalo_sdk_root}/components/net/lwip/lwip/lwip-port/FreeRTOS/sys_arch.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/api/api_lib.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/api/api_msg.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/api/err.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/api/netbuf.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/api/netdb.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/api/netifapi.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/api/sockets.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/api/tcpip.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/apps/http/fs.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/apps/mdns/mdns.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/def.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/dns.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/inet_chksum.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/init.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ip.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv4/autoip.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv4/dhcp.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv4/etharp.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv4/icmp.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv4/igmp.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv4/ip4.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv4/ip4_addr.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv4/ip4_frag.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv6/dhcp6.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv6/ethip6.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv6/icmp6.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv6/inet6.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv6/ip6.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv6/ip6_addr.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv6/ip6_frag.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv6/mld6.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/ipv6/nd6.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/mem.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/memp.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/netif.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/pbuf.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/raw.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/stats.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/sys.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/tcp.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/tcp_in.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/tcp_out.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/timeouts.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/core/udp.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/netif/ethernet.c",
    ]

    sources += [
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/apps/dhcpd/dhcp_server_raw.c",
      "${bouffalo_sdk_root}/components/net/lwip/lwip/src/apps/lwiperf/lwiperf.c",
    ]

    cflags_c = [
      "-Wno-format",
      "-Wno-format-nonliteral",
      "-Wno-format-security",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_freertos",
      ":${sdk_target_name}_config_wifi",
    ]

    public_configs = [ ":${sdk_target_name}_config_lwip" ]
  }

  config("${sdk_target_name}_config_wifi") {
    defines = [
      "__FILENAME__=__FILE__",
      "CFG_IPV6",
    ]
    defines += [ "CONFIG_MACSW_SELECT_INCLUDE=\"macsw_default_config.h\"" ]
    defines += [
      "BOUFFALO_SDK",
      "PLATFORM_PRIVDE_ERRNO",
    ]
    defines += [
      "CONFIG_MACSW_LWIP",
      "CONFIG_USE_MBEDTLS",
      "CONFIG_NO_STDOUT_DEBUG",
    ]

    include_dirs = [
      "${bouffalo_sdk_root}/components/wireless/macsw/inc",
      "${bouffalo_sdk_root}/components/wireless/wifi6/fhost/include",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wifi6_lwip_adapter/include",
    ]
  }

  source_set("${sdk_target_name}_wifi") {
    libs = [
      "${bouffalo_sdk_root}/components/wireless/macsw/lib/libmacsw_bl616_default.a",
      "${bouffalo_sdk_root}/components/wireless/macsw/lib/libmacsw_config_bl616_default.a",
      "${bouffalo_sdk_root}/components/wireless/wifi6/fhost/lib/libfhost_bl616_default.a",
    ]

    sources = [
      "${bouffalo_sdk_root}/components/wireless/macsw_plat.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/fhost_config/fhost_config_buffer.c",
    ]

    defines = [ "BOUFFALO_SDK" ]
    include_dirs = [
      "${bouffalo_sdk_root}/components/wireless/wifi6/macsw_os_adapter/include",
    ]
    sources += [
      "${bouffalo_sdk_root}/components/wireless/wifi6/macsw_os_adapter/src/platform_bouffalo_sdk.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/macsw_os_adapter/src/rtos_al.c",
    ]

    include_dirs +=
        [ "${bouffalo_sdk_root}/components/wireless/wifi6/wifi6_lwip_adapter" ]
    sources += [
      "${bouffalo_sdk_root}/components/wireless/wifi6/wifi6_lwip_adapter/cli_al.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wifi6_lwip_adapter/net_al.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wifi6_lwip_adapter/net_al_ext.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wifi6_lwip_adapter/pbuf_custom_ref.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wifi6_lwip_adapter/tx_buffer_copy.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wifi6_lwip_adapter/wifi_pkt_hooks.c",
    ]

    include_dirs += [
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/l2_packet",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/rsn_supp",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/drivers",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eap_peer",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wps",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eapol_supp",
    ]
    sources += [
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ap_config.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ap_drv_ops.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ap_list.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ap_mlme.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/authsrv.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/beacon.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/bss_load.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ctrl_iface_ap.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/dfs.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/drv_callbacks.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/eap_user_db.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/hostapd.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/hw_features.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ieee802_11.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ieee802_11_auth.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ieee802_11_he.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ieee802_11_ht.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ieee802_11_shared.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ieee802_11_vht.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/ieee802_1x.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/mbo_ap.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/neighbor_db.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/pmksa_cache_auth.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/rrm.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/sta_info.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/tkip_countermeasures.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/utils.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/wmm.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/wnm_ap.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/wpa_auth.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/wpa_auth_glue.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/wpa_auth_ie.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/ap/wps_hostapd.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/common/dragonfly.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/common/hw_features_common.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/common/ieee802_11_common.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/common/sae.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/common/wpa_common.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/drivers/driver_common.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/drivers/driver_macsw.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/drivers/drivers.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eap_common/eap_common.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eap_common/eap_wsc_common.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eap_peer/eap.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eap_peer/eap_methods.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eap_peer/eap_wsc.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eap_server/eap_server.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eap_server/eap_server_identity.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eap_server/eap_server_methods.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eapol_auth/eapol_auth_sm.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/eapol_supp/eapol_supp_sm.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/l2_packet/l2_packet_macsw.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/rsn_supp/pmksa_cache.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/rsn_supp/preauth.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/rsn_supp/wpa.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/rsn_supp/wpa_ie.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/tls/bignum.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils/base64.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils/bitfield.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils/common.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils/crc32.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils/eloop_rtos.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils/ip_addr.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils/os_macsw.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils/uuid.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils/wpa_debug.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/utils/wpabuf.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/aes-omac1.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/aes-unwrap.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/aes-wrap.c",

      #"${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/crypto_openssl.c",
      #"${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/crypto_libtomcrypt.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/crypto_internal-modexp.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/crypto_mbedtls.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/crypto_mbedtls_misc.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/dh_group5.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/dh_groups.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/random.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/rc4.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/sha1-pbkdf2.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/sha1-prf.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/sha256-kdf.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/sha256-prf.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/tls_none.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wps/wps.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wps/wps_attr_build.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wps/wps_attr_parse.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wps/wps_attr_process.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wps/wps_common.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wps/wps_dev_attr.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wps/wps_enrollee.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wps/wps_registrar.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/ap.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/bss.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/bssid_ignore.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/config.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/config_none.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/ctrl_iface.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/ctrl_iface_macsw.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/eap_register.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/events.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/main_macsw.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/mbo.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/notify.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/op_classes.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/robust_av.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/rrm.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/scan.c",

      #"${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/crypto_openssl.c",
      #"${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/src/wpa_crypto/crypto_libtomcrypt.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/sme.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/wmm_ac.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/wnm_sta.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/wpa_supplicant.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/wpas_glue.c",
      "${bouffalo_sdk_root}/components/wireless/wifi6/wpa_supplicant/wpa_supplicant/wps_supplicant.c",
    ]

    cflags_c = [
      "-Wno-error",
      "-Wno-misleading-indentation",
      "-Wno-format",
      "-Wno-format-nonliteral",
      "-Wno-format-security",
      "-Wno-incompatible-pointer-types",
      "-Wno-implicit-function-declaration",
      "-Wno-shadow",
      "-Wno-int-conversion",
      "-Wno-discarded-qualifiers",
      "-Wno-implicit-fallthrough",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_std_drv",
      ":${sdk_target_name}_config_rf",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_sys",
      ":${sdk_target_name}_config_lwip",
      ":${sdk_target_name}_config_mbedtls",
      ":${sdk_target_name}_config_utils",
      ":${sdk_target_name}_config_mm",
      ":${sdk_target_name}_config_freertos",
      ":${sdk_target_name}_config_shell",
    ]

    public_configs = [ ":${sdk_target_name}_config_wifi" ]
  }

  config("${sdk_target_name}_config_ble") {
    defines = [
      "CONFIG_FREERTOS",
      "CONFIG_BLE_ENABLE",
      "BFLB_BLE",
      "CONFIG_BLE",
      "CONFIG_BL_SDK",
      "CONFIG_CON=1",
      "CONFIG_BLE_TX_BUFF_DATA=2",
      "CONFIG_BT_PERIPHERAL",
      "CONFIG_BT_BROADCASTER",

      "CONFIG_BLE_PDS",
      "CONFIG_HW_SEC_ENG_DISABLE",
      "CONFIG_EM_HEAP_DISABLE",
      "CONFIG_BT_CONN",
      "CONFIG_BT_HCI_VS_EVT_USER",
      "CONFIG_BT_ASSERT",

      "CONFIG_BT_GATT_DIS_PNP",
      "CONFIG_BT_GATT_DIS_SERIAL_NUMBER",
      "CONFIG_BT_GATT_DIS_FW_REV",
      "CONFIG_BT_GATT_DIS_HW_REV",
      "CONFIG_BT_GATT_DIS_SW_REV",
      "CONFIG_BT_GATT_DYNAMIC_DB",
      "CONFIG_BT_GATT_SERVICE_CHANGED",
      "CONFIG_BT_KEYS_OVERWRITE_OLDEST",
      "CONFIG_BT_KEYS_SAVE_AGING_COUNTER_ON_PAIRING",
      "CONFIG_BT_BONDABLE",

      "CONFIG_BT_SETTINGS_USE_PRINTK",
    ]

    include_dirs = [
      "${bouffalo_sdk_root}/components/wireless/bluetooth/btblecontroller/btble_inc",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/include",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/include/bluetooth",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/port/include",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/include/zephyr",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/include/misc",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/include",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/include/drivers/bluetooth",
    ]
  }

  source_set("${sdk_target_name}_ble") {
    libs = [ "${bouffalo_sdk_root}/components/wireless/bluetooth/btblecontroller/lib/libbtblecontroller_bl616_ble1m0s1bredr0.a" ]

    include_dirs = [
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/bl_hci_wrapper",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/include",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/include/misc",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/tinycrypt/include/tinycrypt",
    ]

    sources = [
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/bl_hci_wrapper/bl_hci_wrapper.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/atomic_c.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/buf.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/dec.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/log.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/poll.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/rpa.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/common/work_q.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/hci_onchip/hci_driver.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host/att.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host/conn.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host/crypto.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host/gatt.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host/hci_core.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host/keys.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host/l2cap.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host/multi_adv.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host/settings.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/host/uuid.c",
      "${bouffalo_sdk_root}/components/wireless/bluetooth/blestack/src/port/bl_port.c",
    ]

    cflags_c = [
      "-Wno-misleading-indentation",
      "-Wno-type-limits",
      "-Wno-implicit-function-declaration",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_utils",
      ":${sdk_target_name}_config_freertos",
    ]
    public_configs = [ ":${sdk_target_name}_config_ble" ]
  }

  config("${sdk_target_name}_config_openthread_port") {
    include_dirs = [
      "${bouffalo_sdk_root}/components/wireless/thread/openthread_port/include",
      "${bouffalo_sdk_root}/components/wireless/thread/openthread_utils/include",
    ]
  }

  source_set("${sdk_target_name}_openthread_port") {
    import("//build_overrides/openthread.gni")

    defines = [
      "CONFIG_BL_SDK",
      "CHIP_HDR=<bl616.h>",
      "CHIP_GLB_HDR=<bl616_glb.h>",
      "CHIP_SYS_HDR=<bl616_sys.h>",
      "MAC_ADDRESS_MAX_NUM=3",
    ]

    include_dirs = [
      "${bouffalo_sdk_root}/components/wireless/lmac154/lmac154/include",
      "${bouffalo_sdk_root}/components/wireless/thread/openthread_port",
    ]

    sources = [
      "${bouffalo_sdk_root}/components/wireless/thread/openthread_port/ot_alarm.c",
      "${bouffalo_sdk_root}/components/wireless/thread/openthread_port/ot_frame.c",
      "${bouffalo_sdk_root}/components/wireless/thread/openthread_port/ot_linkmetric.c",
      "${bouffalo_sdk_root}/components/wireless/thread/openthread_port/ot_radio.c",
      "${bouffalo_sdk_root}/components/wireless/thread/openthread_port/ot_radio_bflb.c",
      "${bouffalo_sdk_root}/components/wireless/thread/openthread_port/ot_sys_bflb.c",
    ]

    sources += [ "${bouffalo_sdk_root}/components/wireless/thread/openthread_port/ot_settings_littlefs.c" ]

    libs = [ "${bouffalo_sdk_root}/components/wireless/lmac154/lmac154/lib/liblmac154_bl616.a" ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_std_drv",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_sys",
      ":${sdk_target_name}_config_utils",
      ":${sdk_target_name}_config_mm",
      ":${sdk_target_name}_config_littlefs",
      ":${sdk_target_name}_config_freertos",
      ":${sdk_target_name}_config_shell",
    ]

    public_configs = [ ":${sdk_target_name}_config_openthread_port" ]

    public_deps = [
      "${chip_root}/third_party/openthread/platforms:libopenthread-platform-utils",
      "${openthread_root}/src/core:libopenthread_core_headers",
    ]
  }

  config("${sdk_target_name}_config_factory_data") {
    include_dirs =
        [ "${bouffalo_sdk_root}/components/wireless/matter/mfd/include" ]
  }

  source_set("${sdk_target_name}_factory_data") {
    defines = [ "BL_MFD_PLAT_H=\"bl_mfd_bl616.h\"" ]
    sources = [
      "${bouffalo_sdk_root}/components/wireless/matter/mfd/bl_mfd.c",
      "${bouffalo_sdk_root}/components/wireless/matter/mfd/bl_mfd_decrypt_bl616.c",
    ]

    configs += [
      ":${sdk_target_name}_config",
      ":${sdk_target_name}_config_std_drv",
      ":${sdk_target_name}_config_lhal",
      ":${sdk_target_name}_config_utils",
    ]
    public_configs = [ ":${sdk_target_name}_config_factory_data" ]
  }

  group(sdk_target_name) {
    public_deps = [
      ":${sdk_target_name}_board",
      ":${sdk_target_name}_freertos",
      ":${sdk_target_name}_lhal",
      ":${sdk_target_name}_libc",
      ":${sdk_target_name}_mbedtls",
      ":${sdk_target_name}_mm",
      ":${sdk_target_name}_rf",
      ":${sdk_target_name}_shell",
      ":${sdk_target_name}_startup",
      ":${sdk_target_name}_std_drv",
      ":${sdk_target_name}_sys",
      ":${sdk_target_name}_utils",
    ]
    public_deps += [ ":${sdk_target_name}_littlefs" ]

    if (defined(invoker.chip_enable_wifi) && invoker.chip_enable_wifi) {
      public_deps += [ ":${sdk_target_name}_wifi" ]
      public_deps += [ ":${sdk_target_name}_lwip" ]
    } else if (defined(invoker.chip_enable_thread) &&
               invoker.chip_enable_thread) {
      public_deps += [ ":${sdk_target_name}_openthread_port" ]
    } else if (defined(invoker.chip_enable_ethernet) &&
               invoker.chip_enable_ethernet) {
      public_deps += [ ":${sdk_target_name}_eth_phy" ]
      public_deps += [ ":${sdk_target_name}_lwip" ]
    }

    if (defined(invoker.chip_config_network_layer_ble) &&
        invoker.chip_config_network_layer_ble) {
      public_deps += [ ":${sdk_target_name}_ble" ]
    }

    if (defined(invoker.chip_enable_factory_data) &&
        invoker.chip_enable_factory_data) {
      public_deps += [ ":${sdk_target_name}_factory_data" ]
    }
  }
}
